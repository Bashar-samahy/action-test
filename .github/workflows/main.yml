on:
    push 
    
jobs:
  # Job 1: إعداد البيئة
  setup:
    runs-on: ubuntu-latest
    steps:
      - name: تحميل الكود
        uses: actions/checkout@v3
      
      - name: تثبيت Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
  
  # Job 2: البناء (بعد Setup)
  build:
    runs-on: ubuntu-latest
    needs: setup  # ⬅️ يبدأ بعد إتمام setup
    steps:
      - name: تثبيت المكتبات
        run: npm install
      
      - name: بناء المشروع
        run: npm run build
  
  # Job 3: الاختبار (بالتوازي مع Build)
  test:
    runs-on: ubuntu-latest
    needs: setup  # ⬅️ يبدأ بعد إتمام setup
    steps:
      - name: تشغيل الاختبارات
        run: npm test